(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e456b"],{9097:function(e,t,o){"use strict";o.r(t);var a=o("7a23");const c={class:"container"},n={class:"text-end mt-4"},d={class:"table-box"},l={class:"table"},s=Object(a["createStaticVNode"])('<div class="table-thead row text-white w-100 py-3 align-items-center gx-1"><div class="col-3">名稱</div><div class="col-2 text-center"> 折扣 </div><div class="col-3 text-center">到期日</div><div class="col-2 text-center"> 狀態 </div><div class="col-2 text-center">編輯</div></div>',1),r={class:"col-3"},i={class:"col-2 text-center"},p={class:"col-3 text-center"},b={class:"col-2 text-center"},u={key:0,class:"text-success"},m=Object(a["createVNode"])("span",{class:"material-icons"},"toggle_on",-1),O={key:1,class:"text-muted"},j=Object(a["createVNode"])("span",{class:"material-icons"},"toggle_on",-1),h={class:"col-2 text-center"},v={class:"btn-group p-0 p-md-1"},V=Object(a["createVNode"])("span",{class:"material-icons text-3"},"edit",-1),N=Object(a["createVNode"])("span",{class:"material-icons text-3"},"delete",-1),g={class:"pagination justify-content-center"};function C(e,t,o,C,k,x){const y=Object(a["resolveComponent"])("InnerBanner"),f=Object(a["resolveComponent"])("Pagination"),w=Object(a["resolveComponent"])("CouponModal"),M=Object(a["resolveComponent"])("DelModal");return Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],null,[Object(a["createVNode"])(y,{msg:k.msg},null,8,["msg"]),Object(a["createVNode"])("div",c,[Object(a["createVNode"])("div",n,[Object(a["createVNode"])("button",{class:"btn btn-secondary text-white mb-2",type:"button",onClick:t[1]||(t[1]=t=>e.$refs.couponModal.modal("show"))}," 建立新的優惠券 ")]),Object(a["createVNode"])("div",d,[Object(a["createVNode"])("div",l,[s,(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.couponLists,(t,o)=>(Object(a["openBlock"])(),Object(a["createBlock"])("div",{class:"table-tr row text-white w-100 align-items-center py-3 align-items-center gx-1",key:o},[Object(a["createVNode"])("div",r,Object(a["toDisplayString"])(t.title),1),Object(a["createVNode"])("div",i,Object(a["toDisplayString"])(t.percent)+"%",1),Object(a["createVNode"])("div",p,Object(a["toDisplayString"])(e.$filters.date(t.due_date)),1),Object(a["createVNode"])("div",b,[1===t.is_enabled?(Object(a["openBlock"])(),Object(a["createBlock"])("span",u,[m])):(Object(a["openBlock"])(),Object(a["createBlock"])("span",O,[j]))]),Object(a["createVNode"])("div",h,[Object(a["createVNode"])("div",v,[Object(a["createVNode"])("button",{class:"btn btn-outline-primary btn-sm","data-bs-toggle":"modal","data-bs-target":"#couponModal",onClick:e=>x.tempCouponObj(t)},[V],8,["onClick"]),Object(a["createVNode"])("button",{class:"btn btn-outline-danger btn-sm","data-bs-toggle":"modal","data-bs-target":"#delModal",onClick:e=>x.tempCouponObj(t)},[N],8,["onClick"])])])]))),128))])]),Object(a["createVNode"])("ul",g,[e.couponLists.length>1?(Object(a["openBlock"])(),Object(a["createBlock"])(f,{key:0,"current-page":e.pagination.current_page,"total-page":e.pagination.total_pages,onChangePage:e.changePage},null,8,["current-page","total-page","onChangePage"])):Object(a["createCommentVNode"])("",!0)]),Object(a["createVNode"])(w,{coupon:k.tempCoupon,ref:"couponModal",onUpdateCoupon:x.updateCoupon},null,8,["coupon","onUpdateCoupon"]),Object(a["createVNode"])(M,{item:k.tempCoupon,ref:"delModal",onDelItem:x.delCoupon},null,8,["item","onDelItem"])])],64)}var k=o("5502");o("ddb0");const x={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"couponModal","data-bs-target":"#couponModal"},y={class:"modal-dialog",role:"document"},f={class:"modal-content"},w={class:"modal-header border-bottom-0"},M={class:"modal-title font-weight-bold",id:"exampleModalLabel"},_={key:0},B={key:1},D=Object(a["createVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),L={class:"modal-body"},S={class:"needs-validation",novalidate:""},T={class:"mb-3"},$=Object(a["createVNode"])("label",{for:"title"},[Object(a["createVNode"])("small",{class:"text-danger"},"*"),Object(a["createTextVNode"])(" 標題 ")],-1),q={class:"mb-3"},U=Object(a["createVNode"])("label",{for:"coupon_code"},[Object(a["createVNode"])("small",{class:"text-danger"},"*"),Object(a["createTextVNode"])(" 優惠碼 ")],-1),J={class:"mb-3"},P=Object(a["createVNode"])("label",{for:"due_date"},[Object(a["createVNode"])("small",{class:"text-danger"},"*"),Object(a["createTextVNode"])(" 到期日 ")],-1),I={class:"mb-3"},E=Object(a["createVNode"])("label",{for:"price"},[Object(a["createVNode"])("small",{class:"text-danger"},"*"),Object(a["createTextVNode"])(" 折扣百分比 ")],-1),A={class:"mb-3"},F={class:"form-check"},G=Object(a["createVNode"])("label",{class:"form-check-label",for:"is_enabled"},[Object(a["createVNode"])("small",{class:"text-danger"},"*"),Object(a["createTextVNode"])(" 是否啟用 ")],-1),R={class:"d-flex justify-content-end"},z=Object(a["createVNode"])("button",{type:"button",class:"btn btn-gray-100 mr-2","data-bs-dismiss":"modal"},"取消",-1);function H(e,t,o,c,n,d){return Object(a["openBlock"])(),Object(a["createBlock"])("div",x,[Object(a["createVNode"])("div",y,[Object(a["createVNode"])("div",f,[Object(a["createVNode"])("div",w,[Object(a["createVNode"])("h4",M,[n.tempCoupon.id?(Object(a["openBlock"])(),Object(a["createBlock"])("span",_,"編輯優惠卷")):(Object(a["openBlock"])(),Object(a["createBlock"])("span",B,"新增優惠卷"))]),D]),Object(a["createVNode"])("div",L,[Object(a["createVNode"])("form",S,[Object(a["createVNode"])("div",T,[$,Object(a["withDirectives"])(Object(a["createVNode"])("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[1]||(t[1]=e=>n.tempCoupon.title=e),placeholder:"請輸入標題",required:""},null,512),[[a["vModelText"],n.tempCoupon.title]])]),Object(a["createVNode"])("div",q,[U,Object(a["withDirectives"])(Object(a["createVNode"])("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[2]||(t[2]=e=>n.tempCoupon.code=e),placeholder:"請輸入優惠碼",required:""},null,512),[[a["vModelText"],n.tempCoupon.code]])]),Object(a["createVNode"])("div",J,[P,Object(a["withDirectives"])(Object(a["createVNode"])("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[3]||(t[3]=e=>n.due_date=e),required:""},null,512),[[a["vModelText"],n.due_date]])]),Object(a["createVNode"])("div",I,[E,Object(a["withDirectives"])(Object(a["createVNode"])("input",{type:"number",class:"form-control",id:"price",min:"0","onUpdate:modelValue":t[4]||(t[4]=e=>n.tempCoupon.percent=e),placeholder:"請輸入折扣百分比",required:""},null,512),[[a["vModelText"],n.tempCoupon.percent,void 0,{number:!0}]])]),Object(a["createVNode"])("div",A,[Object(a["createVNode"])("div",F,[Object(a["withDirectives"])(Object(a["createVNode"])("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[5]||(t[5]=e=>n.tempCoupon.is_enabled=e),id:"is_enabled",required:""},null,512),[[a["vModelCheckbox"],n.tempCoupon.is_enabled]]),G])]),Object(a["createVNode"])("div",R,[z,Object(a["createVNode"])("button",{type:"submit",class:"btn btn-secondary text-white",onClick:t[6]||(t[6]=(...e)=>d.updateCoupon&&d.updateCoupon(...e))},"確定 ")])])])])])],512)}var K=o("7c2b"),Q=o.n(K),W={props:{coupon:{type:Object,default(){return{}}}},data(){return{tempCoupon:{},due_date:"",couponModal:""}},watch:{coupon(){this.tempCoupon=JSON.parse(JSON.stringify(this.coupon))},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},mounted(){this.couponModal=new Q.a(this.$refs.couponModal,{keyboard:!1,backdrop:"static"}),this.$refs.couponModal.addEventListener("hidden.bs.modal",()=>{this.init()})},methods:{init(){this.tempCoupon={},this.due_date=0;const e=document.querySelector(".needs-validation");e.classList.remove("was-validated")},modal(e){switch(e){case"show":this.couponModal.show();break;case"hide":this.couponModal.hide();break;default:}},updateCoupon(){let e=!1;const t=document.querySelectorAll(".needs-validation");Array.prototype.slice.call(t).forEach(t=>{t.addEventListener("submit",o=>{console.log(t.checkValidity()),t.checkValidity()?e=!0:(o.preventDefault(),o.stopPropagation(),e=!1),t.classList.add("was-validated")},!1)}),setTimeout(()=>{e&&(this.modal("hide"),this.$emit("update-coupon",this.tempCoupon),this.init())})}}};W.render=H;var X=W,Y=o("e417"),Z=o("ac49"),ee={components:{CouponModal:X,DelModal:Y["a"],InnerBanner:Z["a"]},data(){return{msg:"優惠券管理",tempCoupon:{title:"",is_enabled:0,percent:100,code:""}}},computed:{...Object(k["b"])({couponLists:"backend/couponLists",pagination:"backend/pagination"})},async created(){await this.$store.dispatch("backend/fetchGetCoupons")},methods:{async tempCouponObj(e){this.tempCoupon=JSON.parse(JSON.stringify(e))},async updateCoupon(e){await this.$store.dispatch("backend/fetchChangeCoupons",e)},async delCoupon(e){await this.$store.dispatch("backend/fetchRemoveSingleCoupon",e)}}};ee.render=C;t["default"]=ee}}]);
//# sourceMappingURL=chunk-2d0e456b.030435cf.js.map