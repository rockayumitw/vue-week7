{"version":3,"sources":["webpack:///./src/views/Dashboard/Coupons.vue","webpack:///./src/components/modal/CouponModal.vue","webpack:///./src/components/modal/CouponModal.vue?0640","webpack:///./src/views/Dashboard/Coupons.vue?1ab2"],"names":["class","msg","type","$refs","couponModal","modal","couponLists","item","key","title","percent","$filters","date","due_date","is_enabled","data-bs-toggle","data-bs-target","tempCouponObj","length","current-page","pagination","current_page","total-page","total_pages","changePage","coupon","tempCoupon","ref","updateCoupon","delCoupon","id","tabindex","role","aria-labelledby","aria-hidden","data-bs-dismiss","aria-label","novalidate","for","placeholder","required","code","min","true-value","false-value","props","Object","watch","this","JSON","parse","stringify","Math","floor","Date","keyboard","backdrop","addEventListener","init","methods","forms","document","querySelector","classList","remove","state","show","hide","check","querySelectorAll","Array","prototype","slice","call","forEach","form","event","console","log","checkValidity","preventDefault","stopPropagation","add","setTimeout","$emit","render","components","CouponModal","DelModal","InnerBanner","computed","$store","dispatch"],"mappings":"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","file":"js/chunk-2d0e456b.2682f0b6.js","sourcesContent":["<template>\n<InnerBanner :msg=\"msg\" />\n  <div class=\"container\">\n    <div class=\"text-end mt-4\">\n      <button class=\"btn btn-secondary text-white mb-2\"\n      type=\"button\"\n      @click=\"$refs.couponModal.modal('show')\">\n        建立新的優惠券\n      </button>\n      <!-- <button class=\"btn btn-secondary text-white mb-2\"\n      type=\"button\"\n      data-bs-toggle=\"modal\"\n      data-bs-target=\"#couponModal\">\n        建立新的優惠券\n      </button> -->\n    </div>\n    <div class=\"table\">\n      <div class=\"table-thead row text-white w-100 py-3 align-items-center gx-1\">\n        <div class=\"col-3\">名稱</div>\n        <div class=\"col-2 text-center\">\n          折扣\n        </div>\n        <div class=\"col-3 text-center\">到期日</div>\n        <div class=\"col-2 text-center\">\n          狀態\n        </div>\n        <div class=\"col-2 text-center\">編輯</div>\n      </div>\n      <div class=\"table-tr row text-white w-100 align-items-center py-3 align-items-center gx-1\"\n      v-for=\"(item, key) in couponLists\" :key=\"key\">\n        <div class=\"col-3\">{{ item.title }}</div>\n        <div class=\"col-2 text-center\">{{ item.percent }}%</div>\n        <div class=\"col-3 text-center\">{{ $filters.date(item.due_date) }}</div>\n        <div class=\"col-2 text-center\">\n          <span v-if=\"item.is_enabled === 1\" class=\"text-success\">\n            <span class=\"material-icons\">toggle_on</span>\n          </span>\n          <span v-else class=\"text-muted\">\n            <span class=\"material-icons\">toggle_on</span>\n          </span>\n        </div>\n        <div class=\"col-2 text-center\">\n          <div class=\"btn-group p-0 p-md-1\">\n              <button\n              class=\"btn btn-outline-primary btn-sm\"\n              data-bs-toggle=\"modal\"\n              data-bs-target=\"#couponModal\"\n              @click=\"tempCouponObj(item)\"\n              >\n                <span class=\"material-icons text-3\">edit</span>\n              </button>\n              <button class=\"btn btn-outline-danger btn-sm\"\n              data-bs-toggle=\"modal\"\n              data-bs-target=\"#delModal\"\n                      @click=\"tempCouponObj(item)\"\n              >\n              <span class=\"material-icons text-3\">delete</span>\n              </button>\n            </div>\n        </div>\n      </div>\n    </div>\n\n    <ul class=\"pagination justify-content-center\">\n        <Pagination\n          :current-page=\"pagination.current_page\"\n          :total-page=\"pagination.total_pages\"\n          @change-page=\"changePage\"\n          v-if=\"couponLists.length > 1\"\n        ></Pagination>\n      </ul>\n    <CouponModal :coupon=\"tempCoupon\" ref=\"couponModal\" @update-coupon=\"updateCoupon\"/>\n    <DelModal :item=\"tempCoupon\" ref=\"delModal\" @del-item=\"delCoupon\"/>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex';\nimport CouponModal from '@/components/modal/CouponModal.vue';\nimport DelModal from '@/components/modal/DelModal.vue';\nimport InnerBanner from '@/components/InnerBanner.vue';\n\nexport default {\n  components: {\n    CouponModal,\n    DelModal,\n    InnerBanner,\n  },\n  data() {\n    return {\n      msg: '優惠券管理',\n      tempCoupon: {\n        title: '',\n        is_enabled: 0,\n        percent: 100,\n        code: '',\n      },\n    };\n  },\n  computed: {\n    ...mapGetters({\n      couponLists: 'backend/couponLists',\n      pagination: 'backend/pagination',\n    }),\n  },\n  async created() {\n    await this.$store.dispatch('backend/fetchGetCoupons');\n  },\n  methods: {\n    async tempCouponObj(coupon) {\n      this.tempCoupon = JSON.parse(JSON.stringify(coupon));\n    },\n    async updateCoupon(tempCoupon) {\n      await this.$store.dispatch('backend/fetchChangeCoupons', tempCoupon);\n    },\n    async delCoupon(coupon) {\n      await this.$store.dispatch('backend/fetchRemoveSingleCoupon', coupon);\n    },\n  },\n};\n</script>\n","<template>\n  <div\n  class=\"modal fade\" id=\"couponModal\" tabindex=\"-1\" role=\"dialog\"\n       aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\"\n       ref=\"couponModal\" data-bs-target=\"#couponModal\">\n    <div class=\"modal-dialog\" role=\"document\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h4 class=\"modal-title font-weight-bold\" id=\"exampleModalLabel\">\n            <span v-if=\"tempCoupon.id\">編輯優惠卷</span>\n            <span v-else>新增優惠卷</span>\n          </h4>\n          <button type=\"button\" class=\"btn-close\"\n            data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n        </div>\n        <div class=\"modal-body\">\n          <!--表單-->\n          <form class=\"needs-validation\" novalidate>\n            <div class=\"mb-3\">\n              <label for=\"title\">\n                <small class=\"text-danger\">*</small>\n                標題\n              </label>\n              <input type=\"text\" class=\"form-control\"\n              id=\"title\"\n              v-model=\"tempCoupon.title\"\n              placeholder=\"請輸入標題\" required>\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"coupon_code\">\n              <small class=\"text-danger\">*</small>\n              優惠碼\n            </label>\n            <input type=\"text\" class=\"form-control\" id=\"coupon_code\"\n            v-model=\"tempCoupon.code\" placeholder=\"請輸入優惠碼\" required>\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"due_date\">\n              <small class=\"text-danger\">*</small>\n              到期日\n            </label>\n            <input type=\"date\" class=\"form-control\" id=\"due_date\" v-model=\"due_date\" required>\n          </div>\n          <div class=\"mb-3\">\n            <label for=\"price\">\n              <small class=\"text-danger\">*</small>\n              折扣百分比\n            </label>\n            <input type=\"number\" class=\"form-control\" id=\"price\"\n            min=\"0\" v-model.number=\"tempCoupon.percent\" placeholder=\"請輸入折扣百分比\" required>\n          </div>\n          <div class=\"mb-3\">\n            <div class=\"form-check\">\n              <input class=\"form-check-input\" type=\"checkbox\"\n                :true-value=\"1\"\n                :false-value=\"0\"\n                v-model=\"tempCoupon.is_enabled\" id=\"is_enabled\" required>\n              <label class=\"form-check-label\" for=\"is_enabled\">\n                <small class=\"text-danger\">*</small>\n                是否啟用\n              </label>\n            </div>\n          </div>\n          <div class=\"d-flex justify-content-end\">\n            <button type=\"button\" class=\"btn btn-gray-100 mr-2\"\n            data-bs-dismiss=\"modal\">取消</button>\n            <!--data-bs-dismiss=\"modal\"-->\n            <button type=\"submit\" class=\"btn btn-secondary text-white\"\n              @click=\"updateCoupon\">確定\n            </button>\n          </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport Modal from 'bootstrap/js/dist/modal';\n\nexport default {\n  props: {\n    coupon: {\n      type: Object,\n      default() {\n        return {};\n      },\n    },\n  },\n  data() {\n    return {\n      tempCoupon: {},\n      due_date: '',\n      couponModal: '',\n    };\n  },\n  watch: {\n    coupon() {\n      this.tempCoupon = JSON.parse(JSON.stringify(this.coupon));\n    },\n    due_date() {\n      this.tempCoupon.due_date = Math.floor(new Date(this.due_date) / 1000);\n    },\n    // coupon() {\n    //   this.tempCoupon = this.coupon;\n    //   // 將時間格式改為 YYYY-MM-DD\n    //   const dateAndTime = new Date(this.tempCoupon.due_date * 1000)\n    //     .toISOString().split('T');\n    //   [this.due_date] = dateAndTime;\n    // },\n  },\n  mounted() {\n    this.couponModal = new Modal(this.$refs.couponModal, {\n      keyboard: false,\n      backdrop: 'static',\n    });\n    this.$refs.couponModal.addEventListener('hidden.bs.modal', () => {\n      this.init();\n    });\n  },\n  methods: {\n    init() {\n      this.tempCoupon = {};\n      this.due_date = 0;\n      const forms = document.querySelector('.needs-validation');\n      forms.classList.remove('was-validated');\n    },\n    modal(state) {\n      switch (state) {\n        case 'show':\n          this.couponModal.show();\n          break;\n        case 'hide':\n          this.couponModal.hide();\n          break;\n        default:\n      }\n    },\n    updateCoupon() {\n      // 判斷輸入\n      let check = false; // 未通過\n      const forms = document.querySelectorAll('.needs-validation');\n      Array.prototype.slice.call(forms).forEach((form) => {\n        form.addEventListener('submit', (event) => {\n          console.log(form.checkValidity());\n          if (!form.checkValidity()) {\n            event.preventDefault();\n            event.stopPropagation();\n            check = false;\n          } else {\n            check = true;\n          }\n          form.classList.add('was-validated');\n        }, false);\n      });\n      // 非同步\n      setTimeout(() => {\n        if (check) {\n          this.modal('hide');\n          this.$emit('update-coupon', this.tempCoupon);\n          this.init();\n        }\n      });\n    },\n  },\n\n};\n</script>\n","import { render } from \"./CouponModal.vue?vue&type=template&id=878fbc38\"\nimport script from \"./CouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./CouponModal.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./Coupons.vue?vue&type=template&id=1c767960\"\nimport script from \"./Coupons.vue?vue&type=script&lang=js\"\nexport * from \"./Coupons.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}